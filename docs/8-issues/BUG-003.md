# BUG-003: Modo tolerante rejeitado apesar de configuraÃ§Ã£o adequada

## ğŸ“‹ InformaÃ§Ãµes BÃ¡sicas
- **ID:** BUG-003
- **Data:** 2025-07-21
- **Severidade:** High
- **Status:** Open

## ğŸ” DescriÃ§Ã£o
Mesmo utilizando a flag `--tolerant` e tendo dados corrompidos que sÃ£o esperados em testes de robustez, o sistema rejeita o arquivo inteiro quando a taxa de erro excede 10%. O threshold de erro nÃ£o pode ser configurado adequadamente via linha de comando.

## ğŸ“‚ Massa de Dados
- **Arquivo:** data/input/corrupted-test.csv
- **Problemas identificados:**
  - Linha 2: `JoÃ£o"Silva` (aspas nÃ£o fechadas)
  - Linha 6: `"5","Charlie"Wilson"` (aspas mal formatadas)
  - Linha 7: Campo faltando (status)
  - Linha 8: Coluna extra
  - Linha 9: Idade invÃ¡lida
  - Linha 10: Email vazio

## ğŸ”„ Passos para Reproduzir
1. Executar: `npm run dev validate -- --input data/input/corrupted-test.csv --config config/sample-validation.yaml --output tests/test-corrupted-tc005 --verbose --max-rows 10 --tolerant`
2. Sistema detecta 5 erros em 15 linhas (33.3%)
3. Falha com: "Taxa de erro muito alta: 33.3% (mÃ¡ximo permitido: 10.0%)"

## ğŸ“‹ Resultado Esperado
- Modo tolerante deveria processar dados mesmo com alta taxa de erro
- `--error-threshold` deveria permitir configurar limite personalizado
- Sistema deveria continuar processamento com as linhas vÃ¡lidas

## âŒ Resultado Atual
- RejeiÃ§Ã£o total do arquivo
- NÃ£o respeita configuraÃ§Ã£o de tolerÃ¢ncia
- Threshold fixo em 10% nÃ£o configurÃ¡vel via CLI

## ğŸ“ Logs/EvidÃªncias
```
âš ï¸ Encontrados 5 erros de parsing (33.3% das linhas)

[31merror[39m: Validation process failed {"error":"Failed to load CSV file: Taxa de erro muito alta: 33.3% (mÃ¡ximo permitido: 10.0%)"}
```

## ğŸ’¡ PossÃ­veis Causas
1. **Flag --tolerant nÃ£o implementada:** ParÃ¢metro pode ser ignorado
2. **--error-threshold nÃ£o funciona:** OpÃ§Ã£o pode nÃ£o estar sendo aplicada
3. **ValidaÃ§Ã£o hardcoded:** Limite de 10% pode estar fixo no cÃ³digo
4. **Ordem de validaÃ§Ã£o:** VerificaÃ§Ã£o pode acontecer antes da aplicaÃ§Ã£o das flags

## ğŸ”§ SoluÃ§Ã£o Proposta
1. **Imediata:** Verificar se flags --tolerant e --error-threshold estÃ£o sendo aplicadas
2. **CorreÃ§Ã£o:** Implementar configuraÃ§Ã£o dinÃ¢mica do threshold via CLI
3. **Melhoria:** Permitir processamento parcial mesmo com alta taxa de erro

## ğŸ“Š Impacto
- **Funcionalidade:** CrÃ­tica - impede teste de robustez com dados problemÃ¡ticos
- **Usabilidade:** Alta - usuÃ¡rios nÃ£o conseguem processar dados do mundo real
- **Flexibilidade:** Alta - sistema muito rÃ­gido para cenÃ¡rios reais

## ğŸ¯ Teste de VerificaÃ§Ã£o
Tentar: `npm run dev validate -- --input data/input/corrupted-test.csv --config config/sample-validation.yaml --tolerant --error-threshold 0.5`